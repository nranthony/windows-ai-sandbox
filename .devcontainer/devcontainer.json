{
  "name": "UbuntuDev",

  // ------------------------------------------------------------------
  // Build settings
  // ------------------------------------------------------------------
  "build": {
    "dockerfile": "Dockerfile",
    "context": "."
  },

  // ------------------------------------------------------------------
  // Workspace location *inside* the container
  // ------------------------------------------------------------------
  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

  // ------------------------------------------------------------------
  // Use default VS Code workspace mounting (handles permissions correctly)
  // ------------------------------------------------------------------

  // ------------------------------------------------------------------
  // Other environment & runtime tweaks
  // ------------------------------------------------------------------
  "containerEnv": {
    "DOCKER_HOST": "unix:///run/user/1000/docker.sock"
  },
  "runArgs": [
    "--network=ai-sandbox",
    "--userns=host",
    "--gpus",
    "all",
    "--env-file",
    "${localWorkspaceFolder}/.env"
  ],

  // ------------------------------------------------------------------
  // VS Code customisations
  // ------------------------------------------------------------------
  "customizations": {
    "vscode": {
      "settings": {
        "python.condaPath": "/root/miniforge3/bin/conda",          // tells VS Code where conda lives
        "python.defaultInterpreterPath": "/root/miniforge3/bin/python",
        "python.venvPath": "/root/miniforge3/envs",                 // let the extension scan that tree
        "remote.autoForwardPorts": false
      },
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-toolsai.jupyter",
        "ms-python.autopep8",
        "mhutchie.git-graph"
      ]
    }
  },

  // ------------------------------------------------------------------
  // Forwarded ports
  // ------------------------------------------------------------------
  "forwardPorts": [8080, 8501, 8188],

  // ------------------------------------------------------------------
  // Default user in the running container
  // NOTE: Running as root is SAFE with rootless Docker
  //       Container root (UID 0) = Host user (UID 1000)
  // ------------------------------------------------------------------
  "remoteUser": "root",

  // ------------------------------------------------------------------
  // One-shot post-create hook
  // ------------------------------------------------------------------
  "postCreateCommand": "${containerWorkspaceFolder}/.devcontainer/entrypoint.sh"
}
